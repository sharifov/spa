(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{Bxm6:function(t,e,r){"use strict";r.r(e);var s={data:function(){var t=this;return{current:{},settings:[],paymentFinish:!1,form:{value:"",amount:"",valid:!0},taxes:{sum:"",string:""},patternNumber:/^\d{1,10}$/,patternPurse:/^\d{12,15}$/,rules:{required:function(t){return!!t||"Поле должно быть заполнено"},phoneLength:function(t){return t&&17<=t.length||"Номер телефона заполнен не полностью"},cardLength:function(t){return t&&19<=t.length||"Номер карты заполнен не полностью"},number:function(e){return t.patternNumber.test(e)||"Поле должно содержать только целые числа"},amount:function(e){return!!+e&&t.patternNumber.test(e)||"Сумма должна быть больше нуля"},purse:function(e){return t.patternPurse.test(e)||"Поле должно содержать только целые числа"}}}},computed:{user:function(){return this.$store.state.user},userGroup:function(){return this.user?this.$store.state.user.group:null},isAuthenticated:function(){return this.$store.getters.isAuthenticated},paymentsInfo:function(){return this.$store.state.paymentsInfo.methods},hasTaxes:function(){return!0===this.$store.state.settings.taxes}},methods:{GetPaymentsSettings:function(){var t=this;t.$store.getters.axl.post("api/login",{login:t.login,password:t.password}).then(function(e){t.$store.dispatch("UserLogin",e.data),t.$router.push("/dashboard")}).catch(function(e){t.$store.dispatch("HandleError",e)})},handleChangeMethod:function(t){this.current=t,this.ResetForm()},GetTaxes:function(t){if(+t){var e=this,r={profile_id:e.user.profile_id,amount:t,type:e.current.type};this.$store.getters.ax.post("payments/api-v3/payments/calculate",r).then(function(t){e.taxes={sum:parseInt(t.data.amount,10)+parseInt(t.data.commission,10)}}).catch(function(){e.taxes={sum:""}})}},paymentSubmit:function(){var t=this,e=this;if(e.form.valid){var r={profile_id:e.user.profile_id,type:e.current.type,amount:e.form.amount,parameters:{phone_mobile:e.form.value}};e.$store.getters.axl.post("payments/api-v3/payments/create",r).then(function(){e.ResetForm(),t.$store.dispatch("GetProfile"),e.paymentFinish=!0}).catch(function(t){e.$store.dispatch("HandleError",t)})}},ResetForm:function(){this.$refs.form.reset(),this.form.amount="",this.form.value="",this.taxes={sum:"",string:""}},DeclOfNum:function(t){var e=+t;return["балл","балла","баллов"][4<e%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}},mounted:function(){this.current=this.paymentsInfo[0]}},n=r("KHd+"),a=Object(n.a)(s,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:"","pa-0":"","mb-5":""}},[r("v-layout",{attrs:{max:""}},[r("v-flex",{attrs:{xs12:""}},[!t.paymentFinish&&t.paymentsInfo&&t.paymentsInfo.length?r("v-card-title",{staticClass:"px-0"},[t._v("\n        Перевод на мобильный телефон:\n      ")]):t._e(),t._v(" "),t.paymentFinish?[r("v-card-title",{staticClass:"px-0"},[t._v("Перевод успешно отправлен")]),t._v(" "),r("div",[t._v("Ваш платеж принят в работу. Платеж будет обработан в ближайшее время.")]),t._v(" "),r("v-btn",{staticClass:"iek-btn auto-width",attrs:{to:"/profile-transactions"}},[t._v("Все платежи")])]:t._e()],2)],1),t._v(" "),!t.paymentFinish&&t.paymentsInfo&&t.paymentsInfo.length?r("v-layout",{staticClass:"payments",attrs:{max:"",column:"",wrap:""}},[r("div",{staticClass:"payments--types"},[t.user?r("v-layout",{staticClass:"paymentsMemu pt-0",attrs:{row:"",wrap:""}},t._l(t.paymentsInfo,function(e){return r("v-flex",{key:e.id,class:[{paymentsMemuActiveItem:e.type==t.current.type,paymentsMemuItem:!0}],attrs:{"ma-2":""},on:{click:function(r){return t.handleChangeMethod(e)}}},[r("div",{class:"ico-"+e.type+" mode"},[r("span",{staticClass:"mode-title"},[t._v(t._s(e.title))])])])}),1):t._e()],1),t._v(" "),r("div",{staticClass:"payments--number"},[r("v-form",{ref:"form",staticClass:"prizes-form",attrs:{autocomplete:"off",validation:""},model:{value:t.form.valid,callback:function(e){t.$set(t.form,"valid",e)},expression:"form.valid"}},["yandex"===t.current.type||"webmoney"===t.current.type?r("v-text-field",{attrs:{type:"num",label:t.current.title,rules:[t.rules.required,t.rules.purse]},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}}):t._e(),t._v(" "),"rbs"===t.current.type?r("v-text-field",{attrs:{type:"text",label:t.current.title,rules:[t.rules.required,t.rules.number]},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}}):t._e(),t._v(" "),"phone"===t.current.type||"qiwi"===t.current.type?r("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"+7 (###) ###-####",expression:"'+7 (###) ###-####'"}],attrs:{type:"text",label:t.current.title,rules:[t.rules.required,t.rules.phoneLength]},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}}):t._e(),t._v(" "),"card"===t.current.type?r("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"#### #### #### ####",expression:"'#### #### #### ####'"}],attrs:{type:"text",label:t.current.title,rules:[t.rules.required,t.rules.cardLength]},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}}):t._e(),t._v(" "),r("v-text-field",{attrs:{type:"number",label:"Сумма",id:"amount",min:"1",rules:[t.rules.required,t.rules.amount]},on:{input:t.GetTaxes},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),t._v(" "),t.hasTaxes&&0<t.taxes.sum&&t.form&&0<t.form.amount?[t.userGroup&&+t.userGroup.certificates_price_coefficient?r("div",[t._v("\n          Спишется "+t._s(Math.round(t.taxes.sum*t.userGroup.certificates_price_coefficient))+"\n          "+t._s(t.DeclOfNum(Math.round(t.taxes.sum*t.userGroup.certificates_price_coefficient)))+"\n        ")]):r("div",[t._v("\n          Спишется "+t._s(t.taxes.sum)+"\n          "+t._s(t.DeclOfNum(t.taxes.sum))+"\n        ")])]:t._e(),t._v(" "),r("v-btn",{staticClass:"iek-btn",attrs:{disabled:!t.form.valid},on:{click:t.paymentSubmit}},[t._v("\n        Перевести\n      ")])],2)]):t._e()],1)},[],!1,null,null,null);e.default=a.exports}}]);
//# sourceMappingURL=16.f144e972e0881ad1ebf2.js.map