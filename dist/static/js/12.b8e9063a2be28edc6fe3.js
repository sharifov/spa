(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"9TUA":function(t,e,s){"use strict";s.r(e);var a=s("vDqi"),r=s.n(a),i={data:function(){return{dialogOrdered:!1,form:{delivery_email:this.$store.state.user.email,delivery_address:"",is_allow_cancel:!1}}},computed:{user:function(){return this.$store.state.user},userGroup:function(){return this.user?this.$store.state.user.group:null},userHasPassport:function(){return this.user&&this.user.account&&"approved"===this.user.account.status},loading:function(){return this.$store.state.loading},cart:function(){return this.$store.state.eps.cart},cartSummary:function(){return this.$store.state.eps.cartSummary},cartLength:function(){return this.$store.state.eps.cartLength},cards:function(){return this.$store.state.eps.cards},hasPlastic:function(){var t=this,e=!1;return Object.keys(this.cart).forEach(function(s){for(var a=0;a<t.cards.length;a+=1)t.cards[a].type===s&&t.cards[a].is_plastic&&(e=!0)}),e}},mounted:function(){this.dialogOrdered=!1,this.form.is_allow_cancel=!1,this.form.delivery_email=this.$store.state.user.email,this.form.delivery_address="",this.$store.dispatch("GetProfile"),this.GetCards()},methods:{GetCards:function(){var t=this;t.$store.getters.ax.post("profiles/api/cards/list",{group_id:t.user.group_id}).then(function(e){t.$store.commit("eps/SetCards",e.data.cards)})},GetCard:function(t){for(var e=0;e<this.cards.length;e+=1)if(this.cards[e].type===t)return this.cards[e];return null},GetCardTitle:function(t,e){for(var s=this.GetCard(e),a=s.title,r=0;r<s.nominals_text.length;r+=1)s.nominals_text[r].price===parseInt(t,10)&&(a="".concat(a," ").concat(s.nominals_text[r].nominal));return a},GetCardHint:function(t,e){for(var s=this.GetCard(e),a=0;a<s.nominals_text.length;a+=1)if(s.nominals_text[a].price===parseInt(t,10))return"".concat(s.nominals_text[a].text);return""},ChangeQty:function(t,e,s){s<=0?this.RemoveCard(t,e):this.$store.dispatch("eps/ChangeQty",{cardType:t,nominal:e,qty:s})},RemoveCard:function(t,e){this.$store.dispatch("eps/RemoveCard",{cardType:t,nominal:e})},SendOrder:function(){var t=this,e=t.form;e.profile_id=t.user.profile_id,e.items=t.$store.getters["eps/cartItems"],t.$store.getters.axl.post("catalog/api-v3/orders/create",e).then(function(){t.dialogOrdered=!0,t.$store.dispatch("GetProfile",t.user.profile_id),t.$store.dispatch("eps/GetOrders",t.user.profile_id),t.$store.dispatch("eps/ClearCart")}).catch(function(e){t.$store.dispatch("HandleError",e)})},GoToOrders:function(){this.$router.push("/eps-orders")},AutocompleteSearch:function(t,e){if(t){var s=this,a={count:20,query:t};r.a.post("https://dadata.ru/api/v2/suggest/address",a,{headers:{Accept:"application/json, text/javascript, */*; q=0.01",Authorization:"Token 7a77efb8ab6dae6e380c7e438b85360185660f34","Content-Type":"application/json"}}).then(function(t){s.suggestions=t.data.suggestions,e(s.suggestions)}).catch(function(t){console.log(t)})}},AutocompleteSelect:function(t){var e=this;this.suggestions.forEach(function(s){s.value===t.value&&(e.form.address_data=s.data,document.getElementById("delivery-address").focus())})}}},o=s("KHd+"),n=Object(o.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{staticStyle:{height:"100%"},attrs:{fluid:"","pa-0":""}},[s("v-layout",{attrs:{max:"",row:"",wrap:""}},[s("v-flex",{staticClass:"title-page",attrs:{xs12:""}},[s("div",{staticClass:"title-background"}),t._v("\n      Корзина\n    ")])],1),t._v(" "),s("v-layout",{staticClass:"order-page",attrs:{max:"",row:"",wrap:""}},[s("v-flex",{staticClass:"md10 offset-md1 xs12"},[t.userHasPassport?t._e():s("div",{staticClass:"cart-attention"},[s("span",[t._v("Для заказа призов необходимо заполнить Анкету НДФЛ и дождаться подтверждения анкеты модератором сайта. "),s("br"),t._v("Срок проверки анкеты НДФЛ до 5 рабочих дней.")]),t._v(" "),s("v-btn",{staticClass:"iek-btn",attrs:{to:"/passport"}},[s("i",{staticClass:"material-icons mr-1"},[t._v("assignment")]),t._v("Заполнить")])],1),t._v(" "),s("v-layout",{staticClass:"order-page--head"},[s("v-flex",[t._v("Заказ №")]),t._v(" "),s("v-flex",{staticClass:"center",attrs:{md1:"",xs2:""}},[t._v("Кол-во")]),t._v(" "),s("v-flex",{staticClass:"center",attrs:{md1:"",xs2:""}},[t._v("Цена")]),t._v(" "),s("v-flex",{attrs:{xs1:""}})],1),t._v(" "),t._l(t.cart,function(e,a){return s("div",{key:a},t._l(e,function(e,r){return"card"!==r?s("v-layout",{key:r,staticClass:"order-page--block"},[s("v-flex",{staticClass:"order-page--name"},[t._v("\n            "+t._s(t.GetCardTitle(r,a))+"\n          ")]),t._v(" "),s("v-flex",{attrs:{md1:"",xs2:""}},[s("v-text-field",{staticClass:"order-page--qty",attrs:{type:"number",required:""},on:{click:function(e){return t.ChangeQty(a,r,t.cart[a][r])},keyup:function(e){return t.ChangeQty(a,r,t.cart[a][r])}},model:{value:t.cart[a][r],callback:function(e){t.$set(t.cart[a],r,e)},expression:"cart[cardType][nominal]"}})],1),t._v(" "),t.userGroup&&+t.userGroup.certificates_price_coefficient?s("v-flex",{staticClass:"order-page--total",attrs:{md1:"",xs2:""}},[t._v("\n            "+t._s(r*e*t.userGroup.certificates_price_coefficient)+"\n          ")]):s("v-flex",{staticClass:"order-page--total",attrs:{md1:"",xs2:""}},[t._v("\n            "+t._s(r*e)+"\n          ")]),t._v(" "),s("v-flex",{staticClass:"text-center",attrs:{xs1:""}},[s("v-icon",{staticClass:"material-icons size-30 remove-card",attrs:{color:"gray"},on:{click:function(e){return t.RemoveCard(a,r)}}},[t._v("cancel")])],1)],1):t._e()}),1)}),t._v(" "),t.cartLength?s("v-layout",{staticClass:"order-page--footer",attrs:{row:"",wrap:""}},[s("v-flex",[t._v("Итоговая сумма заказа:")]),t._v(" "),s("v-flex",{staticClass:"hidden-xs",attrs:{sm1:""}}),t._v(" "),t.userGroup&&+t.userGroup.certificates_price_coefficient?s("v-flex",{staticClass:"center",attrs:{xs1:""}},[t._v("\n          "+t._s(t.cartSummary*t.userGroup.certificates_price_coefficient)+"\n        ")]):s("v-flex",{staticClass:"center",attrs:{xs1:""}},[t._v(t._s(t.cartSummary))]),t._v(" "),s("v-flex",{attrs:{sm1:""}})],1):s("v-layout",{attrs:{"pa-3":""}},[s("div",{staticClass:"size-16"},[t._v("Ваша корзина пуста")])])],2),t._v(" "),t.cartLength?s("v-flex",{staticClass:"md5 offset-md1 xs12"},[t.userHasPassport?s("div",[s("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.SendOrder(e)}}},[s("v-text-field",{attrs:{type:"text",label:"E-mail для получения заказа",required:"","prepend-icon":"mail_outline",color:"#ffcc02"},model:{value:t.form.delivery_email,callback:function(e){t.$set(t.form,"delivery_email",e)},expression:"form.delivery_email"}}),t._v(" "),t.hasPlastic?s("div",{staticClass:"v-input v-text-field theme--light"},[s("div",{staticClass:"v-input__control"},[s("div",{staticClass:"v-input__slot"},[s("div",{staticClass:"v-text-field__slot"},[s("label",{staticClass:"v-label v-label--active theme--light",staticStyle:{left:"0px",right:"auto",position:"absolute"},attrs:{"aria-hidden":"true"}},[t._v("Адрес доставки")]),t._v(" "),s("el-autocomplete",{attrs:{"fetch-suggestions":t.AutocompleteSearch,placeholder:"Москва, Тверской б-р, д 9","trigger-on-focus":!1,id:"delivery-address",required:""},on:{select:t.AutocompleteSelect},model:{value:t.form.delivery_address,callback:function(e){t.$set(t.form,"delivery_address",e)},expression:"form.delivery_address"}})],1)]),t._v(" "),s("div",{staticClass:"v-text-field__details"},[s("div",{staticClass:"v-messages theme--light"},[s("div",{staticClass:"v-messages__wrapper"})])])])]):t._e(),t._v(" "),s("v-layout",{attrs:{row:""}},[s("v-flex",[s("v-checkbox",{staticClass:"rules-checkbox",attrs:{color:"#ffcc02",id:"cart-allow-cancel"},scopedSlots:t._u([{key:"label",fn:function(){return[s("small",[t._v("\n                    Я уверен в своем заказе и хочу сразу отправить его на обработку. "),s("br"),t._v("\n                    Я понимаю, что это будет быстрее, но его нельзя будет отменить.\n                  ")])]},proxy:!0}],null,!1,2052501453),model:{value:t.form.is_allow_cancel,callback:function(e){t.$set(t.form,"is_allow_cancel",e)},expression:"form.is_allow_cancel"}})],1)],1),t._v(" "),s("v-btn",{staticClass:"iek-btn",attrs:{type:"submit",disabled:t.loading}},[t._v("Заказать")])],1)]):t._e()]):t._e(),t._v(" "),s("v-dialog",{attrs:{width:"500"},model:{value:t.dialogOrdered,callback:function(e){t.dialogOrdered=e},expression:"dialogOrdered"}},[s("v-card",[s("v-card-text",[s("h2",[t._v("Заказ оформлен!")]),t._v(" "),s("div",[t._v("В течение 5 дней сертификаты придут на указанную почту")])]),t._v(" "),s("v-divider"),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{staticClass:"iek-btn ma-0",on:{click:t.GoToOrders}},[t._v("Продолжить")])],1)],1)],1)],1)],1)},[],!1,null,null,null);e.default=n.exports}}]);
//# sourceMappingURL=12.b8e9063a2be28edc6fe3.js.map