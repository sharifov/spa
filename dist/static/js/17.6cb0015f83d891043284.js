(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{ABIi:function(t,e,a){"use strict";a.r(e);var s=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i={data:function(){return{last_name:"",first_name:"",middle_name:"",email:"",phone:"",document_api:{file:"",url:"",name:""},rules:{required:function(t){return!!t||"Поле должно быть заполнено"},email:function(t){return s.test(t)||"Поле E-mail заполнено с ошибками"},phoneRules:function(t){return!!t&&(12===t.replace(/[^+0-9]/g,"").length||"Номер телефона введён не полностью")}}}},computed:{user:function(){return this.$store.state.user},isAuthenticated:function(){return this.$store.getters.isAuthenticated},loading:function(){return this.$store.state.loading},account:function(){return this.$store.state.user.account},isEnabled:function(){return!!(this.last_name&&this.first_name&&this.middle_name&&this.email&&this.phone&&12===this.phone.replace(/[^+0-9]/g,"").length)}},methods:{profileSubmit:function(){var t=this,e=this;if(this.isEnabled&&this.isAuthenticated){var a={profile_id:e.user.profile_id,last_name:e.last_name,first_name:e.first_name,middle_name:e.middle_name,email:e.email,phone:e.user.phone_mobile};e.$store.getters.axl.post("profiles/api/auth/profile-edit",a).then(function(){e.$store.dispatch("ShowInfo","Ваш профиль был успешно обновлён"),t.$router.push("/")}).catch(function(t){e.$store.dispatch("HandleError",t)})}else console.log("minus")},PickDocument:function(){this.$refs.document.click()},OnDocument:function(t){this.OnFilePicked(t)},OnFilePicked:function(t){var e=this,a=this,s=t.target.files;if(void 0!==s[0]){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=[],s=!0,i=!1,r=void 0;try{for(var n,l=t[Symbol.iterator]();!(s=(n=l.next()).done)&&(a.push(n.value),!e||a.length!==e);s=!0);}catch(t){i=!0,r=t}finally{try{s||null==l.return||l.return()}finally{if(i)throw r}}return a}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(s,1)[0];if(i.name.lastIndexOf(".")<=0)return;a.document_api.name=i.name;var r=new FileReader;r.readAsDataURL(i),r.addEventListener("load",function(){a.document_api.url=r.result,console.log(r),e.SetPhoto({name:i.name,url:r.result}),a.$store.dispatch("GetProfile"),a.$forceUpdate()})}else a.app.document_api={file:"",url:"",name:""}},SetPhoto:function(t){var e=t.name.split("."),a={type:e[e.length-1],image:t.url,id:this.user.profile_id};this.$store.getters.axl.post("profiles/api/auth/load-avatar",a)}},mounted:function(){this.isAuthenticated&&(this.$store.dispatch("eps/GetOrders",this.user.profile_id),this.last_name=this.$store.state.user.last_name,this.first_name=this.$store.state.user.first_name,this.middle_name=this.$store.state.user.middle_name,this.email=this.$store.state.user.email,this.phone=this.$store.state.user.phone_mobile)}},r=a("KHd+"),n=Object(r.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticStyle:{height:"100%"},attrs:{fluid:"","pa-0":""}},[a("v-layout",{attrs:{max:"",row:"",wrap:""}},[a("v-flex",{staticClass:"title-page",attrs:{xs12:""}},[a("div",{staticClass:"title-background"}),t._v("\n      Ваш профиль\n    ")])],1),t._v(" "),a("v-layout",{staticClass:"profile",attrs:{max:"",row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"","py-4":""}},[a("div",{staticClass:"profile--top"},[a("div",{staticClass:"profile--avatar",on:{click:t.PickDocument}},[a("v-icon",{staticClass:"profile--avatar-icon"},[t._v("edit")]),t._v(" "),t.document_api&&t.document_api.url?a("img",{staticClass:"profile--avatar-img",attrs:{src:t.document_api.url,alt:"avatar"}}):a("img",{staticClass:"profile--avatar-img",attrs:{src:t.user.avatar_url,alt:"avatar"}})],1),t._v(" "),a("div",{staticClass:"profile--top-wrap"},[a("div",{staticClass:"profile--name"},[t._v(t._s(t.user.full_name))]),t._v(" "),a("div",{staticClass:"profile--balance"},[t._v("\n            Баланс:\n            "),a("b",[t._v(t._s(t.user.balance))])]),t._v(" "),a("v-btn",{staticClass:"iek-btn transactions-btn auto-width",attrs:{to:"/profile-transactions"}},[t._v("\n            Движение баллов\n          ")])],1)])]),t._v(" "),a("v-flex",{attrs:{lg10:"","offset-lg1":"",xs12:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"profile--form pf-left",attrs:{sm12:""}},[a("div",{staticClass:"custom-title"},[t._v("Персональные данные")]),t._v(" "),a("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.profileSubmit(e)}}},[a("v-layout",{staticClass:"align-center justify-space-between"},[a("v-flex",{staticClass:"pr-4",attrs:{sm3:"",xs4:""}},[a("v-subheader",{staticClass:"nowrap"},[t._v("Фамилия "),a("sup",{staticClass:"red--text"},[t._v("*")])])],1),t._v(" "),a("v-flex",[a("v-text-field",{attrs:{type:"text",rules:[t.rules.required],required:"",id:"lastName"},model:{value:t.last_name,callback:function(e){t.last_name=e},expression:"last_name"}})],1)],1),t._v(" "),a("v-layout",{staticClass:"align-center",attrs:{row:""}},[a("v-flex",{staticClass:"pr-4",attrs:{sm3:"",xs4:""}},[a("v-subheader",{staticClass:"nowrap"},[t._v("Имя "),a("sup",{staticClass:"red--text"},[t._v("*")])])],1),t._v(" "),a("v-flex",[a("v-text-field",{attrs:{type:"text",id:"firstName",rules:[t.rules.required],required:""},model:{value:t.first_name,callback:function(e){t.first_name=e},expression:"first_name"}})],1)],1),t._v(" "),a("v-layout",{staticClass:"align-center",attrs:{row:""}},[a("v-flex",{staticClass:"pr-4",attrs:{sm3:"",xs4:""}},[a("v-subheader",{staticClass:"nowrap"},[t._v("Отчество "),a("sup",{staticClass:"red--text"},[t._v("*")])])],1),t._v(" "),a("v-flex",[a("v-text-field",{attrs:{type:"text",id:"middleName",rules:[t.rules.required],required:""},model:{value:t.middle_name,callback:function(e){t.middle_name=e},expression:"middle_name"}})],1)],1),t._v(" "),a("v-layout",{staticClass:"align-center",attrs:{row:""}},[a("v-flex",{staticClass:"pr-4",attrs:{sm3:"",xs4:""}},[a("v-subheader",{staticClass:"nowrap"},[t._v("E-mail "),a("sup",{staticClass:"red--text"},[t._v("*")])])],1),t._v(" "),a("v-flex",[a("v-text-field",{attrs:{type:"text",id:"email",rules:[t.rules.required,t.rules.email]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),t._v(" "),a("v-layout",{staticClass:"align-center",attrs:{row:""}},[a("v-flex",{staticClass:"pr-4",attrs:{sm3:"",xs4:""}},[a("v-subheader",{staticClass:"nowrap"},[t._v("Телефон "),a("sup",{staticClass:"red--text"},[t._v("*")])])],1),t._v(" "),a("v-flex",[a("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"+7 (###) ###-####",expression:"'+7 (###) ###-####'"}],attrs:{type:"text",rules:[t.rules.required,t.rules.phoneRules]},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1),t._v(" "),a("v-text-field",{staticStyle:{display:"none"},on:{click:t.PickDocument},model:{value:t.document_api.name,callback:function(e){t.$set(t.document_api,"name",e)},expression:"document_api.name"}}),t._v(" "),a("input",{ref:"document",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*, application/pdf"},on:{change:t.OnDocument}})],1)]),t._v(" "),a("div")],1),t._v(" "),a("div"),t._v(" "),a("v-flex",{staticClass:"display-flex justify-center",attrs:{sm6:"","offset-sm3":"",xs12:""}},[a("v-btn",{staticClass:"iek-btn",attrs:{type:"submit",disabled:t.loading||!t.isEnabled},on:{click:t.profileSubmit}},[t._v("\n        Сохранить\n      ")])],1)],1)],1)],1)},[],!1,null,null,null);e.default=n.exports}}]);
//# sourceMappingURL=17.6cb0015f83d891043284.js.map